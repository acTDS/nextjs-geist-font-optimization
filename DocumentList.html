<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bảng Tổng Hợp Tài Liệu - Trung Tâm Ngoại Ngữ 68</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Link Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* General font and background settings */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5; /* Lighter background color */
            color: #333333; /* Default text color */
            display: flex;
            flex-direction: column; /* Ensure main content stacks vertically */
        }

        /* Main content area */
        .main-content {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            background-color: #ffffff; /* White background for main content */
            width: 100%;
            margin: 0;
            overflow: hidden; /* Ensure content doesn't overflow */
        }

        /* Header */
        .header {
            background-color: #2d3748;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15); /* Synchronized shadow */
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 30px; /* Increased gap between logo and title */
            flex-grow: 1; /* Allow this element to expand to fill space */
            justify-content: flex-start; /* Keep content left-aligned */
        }

        .header-logo img {
            height: 100px;
            width: 100px;
            border-radius: 50%;
            object-fit: cover;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .header-title {
            font-size: 1.8rem;
            font-weight: 600;
            color: #e2e8f0;
            white-space: nowrap;
        }

        .header-date {
            font-size: 1rem;
            color: #a0aec0;
            white-space: nowrap;
            margin-right: 20px; /* Space between date and icon */
        }

        .header-right {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .header-icons {
            position: relative; /* Add position relative for notification dropdown alignment */
        }

        .header-icons svg {
            width: 24px;
            height: 24px;
            color: #a0aec0;
            cursor: pointer;
            transition: color 0.2s ease-in-out;
        }

        .header-icons svg:hover {
            color: #ffffff;
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -5px; /* Adjust as needed */
            right: -5px; /* Adjust as needed */
            background-color: #f00; /* Red color */
            color: white;
            font-size: 0.7rem;
            padding: 2px 6px;
            border-radius: 50%;
            min-width: 18px; /* Ensure it's round for single digits */
            text-align: center;
            font-weight: bold;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            display: none; /* Hidden by default, show with JS if count > 0 */
        }

        /* Notification Dropdown */
        .notification-dropdown {
            position: absolute;
            top: calc(100% + 10px); /* Distance from notification icon */
            right: 0;
            background-color: #2d3748;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
            z-index: 10;
            min-width: 280px; /* Slightly wider */
            max-height: 300px; /* Height limit */
            overflow-y: auto; /* Add scrollbar if too long */
            display: none;
            flex-direction: column;
            padding: 0; /* Changed to 0, inner elements will have padding */
            margin-top: 5px;
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.2s ease-out, transform 0.2s ease-out;
        }

        .notification-dropdown.show {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        /* Notification Dropdown Header */
        .notification-dropdown-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 15px;
            background-color: #4a5568; /* Slightly lighter background for header */
            color: #e2e8f0;
            font-weight: 600;
            font-size: 0.95rem;
            border-bottom: 1px solid #667eea;
        }

        .notification-dropdown-header h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
        }

        .notification-dropdown-header button {
            background: none;
            border: none;
            color: #a0aec0;
            font-size: 0.85rem;
            cursor: pointer;
            transition: color 0.2s;
        }

        .notification-dropdown-header button:hover {
            color: #ffffff;
        }

        /* Notification List */
        .notification-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .notification-list li {
            padding: 10px 15px;
            color: #e2e8f0;
            border-bottom: 1px solid #4a5568;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }

        .notification-list li:last-child {
            border-bottom: none;
        }

        .notification-list li:hover {
            background-color: #4a5568;
        }

        .notification-list li strong {
            color: #ffffff;
        }

        .notification-list li .time {
            display: block;
            font-size: 0.75rem;
            color: #a0aec0;
            margin-top: 2px;
        }

        .notification-dropdown .no-notifications {
            padding: 10px 15px;
            color: #a0aec0;
            text-align: center;
            font-style: italic;
            display: none; /* Hidden by default, shown by JS */
        }

        /* User Info and Dropdown */
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            position: relative;
            cursor: pointer;
            padding: 5px 0;
        }

        .user-info img {
            width: 36px; /* Slightly larger avatar size */
            height: 36px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #4299e1; /* Prominent blue border */
        }

        .user-details {
            display: flex;
            flex-direction: column;
            text-align: left; /* Left-align user info */
            white-space: nowrap;
            font-size: 0.95rem;
            font-weight: 500;
            color: #e2e8f0;
        }

        .user-details .user-name {
            font-weight: 600;
            font-size: 1rem;
            margin-bottom: 2px;
        }

        .user-details .user-title {
            font-size: 0.85rem;
            color: #a0aec0;
        }

        .user-dropdown {
            position: absolute;
            top: calc(100% + 10px); /* Distance from user-info */
            right: 0;
            background-color: #2d3748;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
            z-index: 10;
            min-width: 160px; /* Slightly wider */
            display: none;
            flex-direction: column;
            padding: 10px 0;
            opacity: 0;
            transform: translateY(-10px);
            transition: opacity 0.2s ease-out, transform 0.2s ease-out;
        }

        .user-dropdown.show {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        .user-dropdown button {
            background: none;
            border: none;
            color: #e2e8f0;
            padding: 10px 15px;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
            border-radius: 0;
            font-size: 0.95rem;
        }

        .user-dropdown button:hover {
            background-color: #4a5568;
            color: #ffffff;
        }

        /* Dashboard Body */
        .dashboard-body {
            padding: 30px;
            flex-grow: 1;
            background-color: #ffffff; /* White background for the body part */
        }

        .dashboard-title {
            font-size: 2.2rem; /* Larger title */
            font-weight: 700;
            color: #2c3e50; /* Darker black color */
            margin-bottom: 30px;
            text-align: center; /* Center title */
            padding-bottom: 15px;
            border-bottom: 3px solid #3498db; /* More prominent bottom border */
        }

        /* Table Section */
        .table-section {
            background-color: #fdfdfd; /* Near-white background */
            padding: 25px; /* Increased padding */
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08); /* Lighter shadow */
            border: 1px solid #e0e0e0; /* Lighter border */
        }

        .table-section h2 {
            color: #2c3e50; /* Dark text */
            margin-bottom: 25px; /* Increased margin-bottom */
            font-size: 1.8em;
            text-align: center;
            border-bottom: 2px solid #f39c12;
            padding-bottom: 12px; /* Increased padding-bottom */
        }

        .table-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px; /* Increased margin-bottom */
            flex-wrap: wrap;
            gap: 15px; /* Increased gap */
        }

        .add-button {
            background-color: #28a745; /* Green for Add */
            color: white;
            padding: 12px 20px; /* Increased padding */
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
            display: flex;
            align-items: center;
            gap: 10px; /* Increased gap */
            box-shadow: 0 4px 8px rgba(0,0,0,0.15); /* More prominent shadow */
        }

        .add-button:hover {
            background-color: #218838;
            transform: translateY(-2px); /* More pronounced lift */
            box-shadow: 0 6px 12px rgba(0,0,0,0.2);
        }

        .add-button svg {
            width: 22px; /* Slightly larger icon */
            height: 22px;
        }

        .search-bar {
            flex-grow: 1;
            max-width: 450px; /* Increased max-width */
        }

        .search-bar input[type="text"] {
            width: 100%;
            padding: 12px 15px; /* Increased padding */
            border: 1px solid #ced4da; /* More distinct border */
            border-radius: 8px; /* Rounded corners */
            background-color: #f8f9fa; /* Very light background */
            color: #495057; /* Darker text color */
            font-size: 1em;
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .search-bar input[type="text"]:focus {
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        .table-container {
            overflow-x: auto;
            max-height: 65vh; /* Increased max-height */
            overflow-y: auto;
            border-radius: 8px;
            border: 1px solid #dee2e6; /* Stronger overall table border */
            box-shadow: 0 2px 8px rgba(0,0,0,0.05); /* Lighter shadow */
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1400px; /* Increased min-width for more columns */
        }

        .data-table th, .data-table td {
            padding: 15px 20px; /* Increased padding for larger cells */
            text-align: left;
            border: 1px solid #e9ecef; /* More distinct cell borders */
            color: #343a40; /* Dark text */
            white-space: nowrap;
            font-size: 0.95em; /* Slightly increased font size */
        }

        .data-table th {
            background-color: #e9ecef; /* Lighter table header background */
            font-weight: 600;
            position: sticky;
            top: 0;
            z-index: 1;
            color: #495057; /* Darker text for headers */
            text-transform: uppercase; /* Uppercase text */
            letter-spacing: 0.05em; /* Letter spacing */
        }

        .data-table tbody tr:nth-child(even) { /* Add zebra striping */
            background-color: #f8f9fa;
        }

        .data-table tbody tr:hover {
            background-color: #e2f0fe; /* Lighter hover effect */
            cursor: pointer;
        }

        .data-table .actions button {
            color: white;
            padding: 8px 14px; /* Increased padding */
            border: none;
            border-radius: 6px; /* Slightly more rounded */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s;
            margin-right: 8px; /* Increased margin */
            font-size: 0.9em;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .data-table .actions .view-btn { background-color: #007bff; }
        .data-table .actions .view-btn:hover { background-color: #0056b3; transform: translateY(-1px); }
        .data-table .actions .download-btn { background-color: #28a745; }
        .data-table .actions .download-btn:hover { background-color: #218838; transform: translateY(-1px); }
        .data-table .actions .edit-btn { background-color: #ffc107; color: #333333; } /* Orange for Edit, dark text */
        .data-table .actions .edit-btn:hover { background-color: #e0a800; transform: translateY(-1px); }
        .data-table .actions .delete-btn { background-color: #dc3545; }
        .data-table .actions .delete-btn:hover { background-color: #c82333; transform: translateY(-1px); }


        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: #ffffff;
            padding: 35px; /* Increased padding */
            border-radius: 12px; /* More rounded corners */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4); /* More pronounced shadow */
            width: 90%;
            max-width: 700px; /* Increased max width */
            max-height: 90vh;
            overflow-y: auto;
            color: #333333;
            position: relative;
            transform: scale(0.95); /* Initial smaller scale for animation */
            transition: transform 0.3s ease-out;
        }

        .modal-overlay.show .modal-content {
            transform: scale(1); /* Scale up when shown */
        }

        .modal-content h3 {
            font-size: 1.8em; /* Larger title */
            margin-bottom: 25px; /* Increased margin */
            text-align: center;
            color: #2c3e50;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 15px; /* Increased padding */
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px; /* Increased gap */
        }

        .form-group.col-span-2 { /* New style for spanning two columns */
            grid-column: span 2 / span 2;
        }

        .modal-content .form-group { margin-bottom: 0; } /* Remove margin-bottom as gap handles spacing */
        .modal-content .form-group label {
            display: block;
            margin-bottom: 8px; /* Increased margin */
            font-weight: 600; /* Bolder label */
            color: #555555;
            font-size: 0.95em;
        }

        .modal-content .form-group input,
        .modal-content .form-group select,
        .modal-content .form-group textarea { /* Added textarea */
            width: 100%;
            background-color: #fcfcfc; /* Very light input background */
            color: #333333;
            border: 1px solid #ced4da;
            border-radius: 8px; /* Rounded corners */
            padding: 12px 15px; /* Increased padding */
            font-size: 1em;
            box-sizing: border-box;
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .modal-content .form-group input:focus,
        .modal-content .form-group select:focus,
        .modal-content .form-group textarea:focus { /* Added textarea */
            border-color: #007bff;
            box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
        }

        .modal-content .form-group input[readonly],
        .modal-content .form-group select[readonly],
        .modal-content .form-group textarea[readonly] { /* Added textarea */
            background-color: #e9ecef;
            cursor: not-allowed;
            color: #666666;
        }
        /* Style for file input and upload button (removed from HTML, keeping style for reference if needed later) */
        .file-upload-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .file-upload-group input[type="file"] {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #cccccc;
            border-radius: 5px;
            background-color: #f8f8f8;
            color: #000000;
        }
        .file-upload-group button {
            background-color: #007bff; /* Blue for Upload File */
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .file-upload-group button:hover {
            background-color: #0056b3;
        }


        .modal-content .form-actions {
            margin-top: 30px; /* Increased margin */
            display: flex;
            justify-content: center;
            gap: 20px; /* Increased gap */
            grid-column: 1 / -1; /* Span across all columns in grid */
        }

        .modal-content .form-actions button {
            padding: 12px 25px; /* Increased padding */
            font-size: 1em;
            border-radius: 8px; /* Rounded corners */
            font-weight: 600;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
        }
        .modal-content .form-actions .submit-button { background-color: #28a745; color: white; }
        .modal-content .form-actions .submit-button:hover { background-color: #218838; transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
        .modal-content .form-actions .cancel-button { background-color: #6c757d; color: white; }
        .modal-content .form-actions .cancel-button:hover { background-color: #5a6268; transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }


        .modal-close-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 1.8em; /* Larger close button */
            color: #888888;
            cursor: pointer;
            transition: color 0.2s;
        }
        .modal-close-btn:hover { color: #333333; }

        /* Tabs for View/Edit Document Modal (removed, keeping styles for consistency if re-added) */
        .modal-tabs {
            display: flex;
            margin-top: 20px;
            margin-bottom: 20px; /* Space between tabs and content */
            border-bottom: 2px solid #e0e0e0; /* More prominent border */
            gap: 5px;
        }
        .modal-tab-button {
            padding: 12px 20px; /* Increased padding */
            cursor: pointer;
            border: none;
            background-color: #f0f0f0; /* Light background for inactive tabs */
            color: #666666;
            font-weight: 600;
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }
        .modal-tab-button:hover {
            background-color: #e2e8f0;
            color: #2d3748;
        }
        .modal-tab-button.active {
            background-color: #ffffff;
            color: #2d3748;
            border-color: #f39c12; /* Orange active tab indicator */
            border-bottom: 2px solid #ffffff; /* Create "lifted" effect */
            transform: translateY(2px);
            box-shadow: 0 -2px 5px rgba(0,0,0,0.05);
            z-index: 2;
        }
        .modal-tab-content {
            padding-top: 25px; /* Increased padding */
        }
        .modal-tab-content.hidden {
            display: none;
        }

        /* Version History Table within modal (removed, keeping styles for consistency if re-added) */
        .version-history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        .version-history-table th, .version-history-table td {
            padding: 12px 15px; /* Increased padding */
            border: 1px solid #e9ecef; /* Consistent cell borders */
            text-align: left;
            font-size: 0.95em;
            white-space: nowrap;
            color: #343a40;
        }
        .version-history-table th {
            background-color: #e9ecef; /* Consistent header background */
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #495057;
        }
        .version-history-table tbody tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        .version-history-table tbody tr:hover {
            background-color: #e2f0fe;
        }
        .version-history-table .download-version-btn {
            background-color: #007bff; /* Blue for Download */
            color: white;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .version-history-table .download-version-btn:hover {
            background-color: #0056b3;
        }


        /* CSS for Full-screen Loading Overlay */
        .full-screen-loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999; /* Synchronized z-index */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .full-screen-loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .full-screen-spinner {
            border: 8px solid rgba(255, 255, 255, 0.3);
            border-top: 8px solid #fff;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Custom Message Box Overlay */
        .custom-message-box-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000; /* Synchronized z-index */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .custom-message-box-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .custom-message-box-content {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 400px;
            text-align: center;
            color: #333333;
        }

        .custom-message-box-content p {
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .custom-message-box-content button {
            background-color: #4299e1;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .custom-message-box-content button:hover {
            background-color: #3182ce;
        }

        /* Custom Confirmation Box Overlay for delete */
        .confirmation-box-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000; /* Synchronized z-index */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }

        .confirmation-box-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        .confirmation-box-content {
            background-color: #ffffff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 400px;
            text-align: center;
            color: #333333;
        }

        .confirmation-box-content p {
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .confirmation-box-content .flex button {
            padding: 10px 20px;
            font-weight: bold;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        /* Responsive adjustments */
        @media (max-width: 1024px) {
            .header-date {
                display: none;
            }
            .dashboard-title {
                font-size: 1.8rem;
            }
            .table-section h2 {
                font-size: 1.5em;
            }
            .table-controls {
                flex-direction: column;
                align-items: stretch;
            }
            .search-bar {
                max-width: 100%;
            }
            .data-table th, .data-table td {
                padding: 12px 15px;
            }
        }

        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
                padding: 10px 15px;
            }
            .header-left {
                width: 100%;
                justify-content: space-between;
                gap: 10px;
            }
            .header-right {
                width: 100%;
                justify-content: flex-end;
            }
            .header-title {
                font-size: 1.5rem;
            }
            .header-logo img {
                height: 80px;
                width: 80px;
            }
            .user-info {
                margin-top: 10px;
            }
            .user-details {
                display: none;
            }
            .dashboard-body {
                padding: 15px;
            }
            .dashboard-title {
                font-size: 1.6rem;
                margin-bottom: 20px;
            }
            .table-section {
                padding: 15px;
            }
            .table-section h2 {
                font-size: 1.3em;
                margin-bottom: 15px;
            }
            .data-table {
                min-width: 800px; /* Adjust as needed for content */
            }
            .data-table th, .data-table td {
                padding: 10px;
                font-size: 0.85em;
            }
            .data-table .actions button {
                padding: 6px 10px;
                font-size: 0.8em;
                margin-right: 3px;
            }
            .modal-content {
                width: 95%;
                padding: 20px;
            }
            .form-grid {
                grid-template-columns: 1fr;
            }
            .modal-content .form-actions {
                flex-direction: column;
                gap: 10px;
            }
            .modal-content .form-actions button {
                width: 100%;
            }
            .modal-close-btn {
                font-size: 1.3em;
                top: 10px;
                right: 10px;
            }
        }
    </style>
</head>
<!-- userRole will be set by C# based on actual user permissions -->
<body data-user-role="normal"> <!-- Default to 'normal' for testing, C# will override -->
    <!-- Full-screen Loading Overlay -->
    <div id="fullScreenLoadingOverlay" class="full-screen-loading-overlay">
        <div class="full-screen-spinner"></div>
    </div>

    <!-- Custom Message Box Overlay for general messages -->
    <div id="customMessageBoxOverlay" class="custom-message-box-overlay">
        <div class="custom-message-box-content">
            <p id="customMessageText"></p>
            <button id="closeCustomMessageBox" class="bg-blue-500 hover:bg-blue-700 text-white px-4 py-2 rounded-md">Đóng</button>
        </div>
    </div>

    <!-- Custom Confirmation Box Overlay for delete -->
    <div id="confirmationBoxOverlay" class="confirmation-box-overlay">
        <div class="confirmation-box-content">
            <p id="confirmationMessageText"></p>
            <div class="flex justify-center gap-4 mt-4">
                <button id="confirmActionButton" class="bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-md transition duration-300">Xác nhận</button>
                <button id="cancelActionButton" class="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-md transition duration-300">Hủy</button>
            </div>
        </div>
    </div>

    <!-- Modal Yêu cầu thêm tài liệu mới -->
    <div id="addDocumentRequestModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeAddRequestModalBtn">&times;</button>
            <h3>Yêu Cầu Thêm Tài Liệu Mới</h3>
            <form id="addDocumentRequestForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="addDocumentName">Tên tài liệu</label>
                        <input type="text" id="addDocumentName" name="documentName" placeholder="Nhập tên tài liệu" required>
                    </div>
                    <div class="form-group">
                        <label for="addDocumentType">Loại tài liệu</label>
                        <select id="addDocumentType" name="documentType" required>
                            <option value="">Đang tải loại tài liệu...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="addDepartment">Phòng ban</label>
                        <select id="addDepartment" name="department" required>
                            <option value="">Đang tải phòng ban...</option>
                        </select>
                    </div>
                    <div class="form-group col-span-2">
                        <label for="addDescription">Mô tả</label>
                        <textarea id="addDescription" name="description" rows="3" placeholder="Mô tả ngắn gọn về tài liệu"></textarea>
                    </div>
                    <div class="form-group col-span-2">
                        <label for="addReasonForRequest">Lý do yêu cầu</label>
                        <textarea id="addReasonForRequest" name="reasonForRequest" rows="2" placeholder="Giải thích lý do cần thêm tài liệu này" required></textarea>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="submit-button">Gửi Yêu Cầu</button>
                    <button type="button" class="cancel-button" id="cancelAddRequestBtn">Hủy</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal Xem tài liệu (chỉ xem) -->
    <div id="viewEditDocumentModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeViewEditModalBtn">&times;</button>
            <h3>Thông Tin Tài Liệu</h3>
            <!-- Tabs removed, only content for details remains -->
            <div id="documentDetailsTab" class="modal-tab-content">
                <form id="editDocumentForm">
                    <input type="hidden" id="editDocumentId" name="documentId">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="editDocumentName">Tên tài liệu</label>
                            <input type="text" id="editDocumentName" name="documentName" readonly>
                        </div>
                        <div class="form-group">
                            <label for="editDocumentType">Loại tài liệu</label>
                            <select id="editDocumentType" name="documentType" disabled>
                                <option value="">Đang tải loại tài liệu...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editDepartment">Phòng ban</label>
                            <select id="editDepartment" name="department" disabled>
                                <option value="">Đang tải phòng ban...</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="editStatus">Trạng thái</label>
                            <select id="editStatus" name="status" disabled>
                                <option value="">Đang tải trạng thái...</option>
                            </select>
                        </div>
                        <div class="form-group col-span-2">
                            <label for="editDescription">Mô tả</label>
                            <textarea id="editDescription" name="description" rows="3" readonly></textarea>
                        </div>
                        <div class="form-group">
                            <label for="editCreatedDate">Ngày tạo</label>
                            <input type="text" id="editCreatedDate" readonly>
                        </div>
                        <div class="form-group">
                            <label for="editCreatorEmployeeId">Người tạo</label>
                            <input type="text" id="editCreatorEmployeeId" readonly>
                        </div>
                        <!-- Removed editVersionNoteGroup and form-actions -->
                    </div>
                </form>
            </div>
            <!-- documentVersionsTab (Lịch Sử Phiên Bản) removed -->
        </div>
    </div>

    <!-- Main content area -->
    <div class="main-content">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <div class="header-logo">
                    <img src="https://placehold.co/100x100/2d3748/e2e8f0?text=LOGO" alt="Trung Tâm Ngoại Ngữ 68">
                </div>
                <div class="header-title">Trung Tâm Ngoại Ngữ 68</div>
            </div>
            <div class="header-right">
                <div id="currentDate" class="header-date"></div>
                <div class="header-icons">
                    <!-- Notification icon -->
                    <svg id="notificationIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucude-bell"><path d="M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9" /><path d="M10.3 21a1.94 1.94 0 0 0 3.4 0" /></svg>
                    <span id="notificationCountBadge" class="notification-badge">3</span>
                    <!-- Notification Dropdown -->
                    <div id="notificationDropdown" class="notification-dropdown">
                        <div class="notification-dropdown-header">
                            <h3>Thông báo</h3>
                            <button id="clearNotificationsBtn">Xóa tất cả</button>
                        </div>
                        <ul id="notificationList" class="notification-list">
                            <!-- Notifications will be rendered here -->
                            <li class="no-notifications">Không có thông báo mới.</li>
                        </ul>
                    </div>
                </div>
                <!-- User Info and Dropdown -->
                <div class="user-info" id="userInfo">
                    <img src="https://placehold.co/36x36/1a202c/e2e8f0?text=U" alt="User Avatar" />
                    <div class="user-details">
                        <span class="user-name" id="employeeName">Đang tải...</span>
                        <span class="user-title" id="employeeTitle"></span>
                    </div>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-chevron-down" style="cursor: pointer; color: #a0aec0;">
                        <path d="m6 9 6 6 6-6" />
                    </svg>
                    <div class="user-dropdown" id="userDropdown">
                        <button id="changePasswordBtn">Đổi Mật Khẩu</button>
                        <button id="logoutBtn">Đăng Xuất</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Nội dung chính của Dashboard - Bảng Tổng Hợp Tài Liệu -->
        <div class="dashboard-body">
            <h1 class="dashboard-title">Bảng Tổng Hợp Tài Liệu</h1>

            <div class="table-section">
                <h2>Danh Sách Tài Liệu</h2>
                <div class="table-controls">
                    <button id="addDocumentRequestBtn" class="add-button">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucude-plus"><path d="M12 5v14"/><path d="M5 12h14"/></svg>
                        Yêu Cầu Thêm Tài Liệu Mới
                    </button>
                    <div class="search-bar">
                        <input type="text" id="searchInput" placeholder="Tìm kiếm theo bất kỳ trường nào..." />
                    </div>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>ID Tài liệu</th>
                                <th>Tên Tài liệu</th>
                                <th>Loại Tài liệu</th>
                                <th>Phòng ban</th>
                                <th>Trạng thái</th>
                                <th>Ngày chỉnh sửa</th>
                                <th>Người tạo</th>
                                <th>Hành động</th>
                            </tr>
                        </thead>
                        <tbody id="documentTableBody">
                            <!-- Dữ liệu tài liệu sẽ được tải động từ C# -->
                            <tr><td colspan="8" class="text-center text-gray-500 py-4">Đang tải dữ liệu tài liệu...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log("Script execution started.");

        const fullScreenLoadingOverlay = document.getElementById('fullScreenLoadingOverlay');
        const customMessageBoxOverlay = document.getElementById('customMessageBoxOverlay');
        const customMessageText = document.getElementById('customMessageText');
        const closeCustomMessageBox = document.getElementById('closeCustomMessageBox');

        // Confirmation Box elements
        const confirmationBoxOverlay = document.getElementById('confirmationBoxOverlay');
        const confirmationMessageText = document.getElementById('confirmationMessageText');
        const confirmActionButton = document.getElementById('confirmActionButton');
        const cancelActionButton = document.getElementById('cancelActionButton');

        let pendingAction = null; // To store the action to be confirmed (e.g., delete)
        let currentUserRole = document.body.dataset.userRole; // Get role from data attribute

        /**
         * Hàm để điền dữ liệu vào dropdown
         * @param {string} selectElementId - ID của phần tử select.
         * @param {Array<Object>} data - Mảng các đối tượng { value: ..., text: ... }.
         * @param {string} placeholderText - Văn bản mặc định cho tùy chọn đầu tiên.
         */
        function populateDropdown(selectElementId, data, placeholderText) {
            const selectElement = document.getElementById(selectElementId);
            selectElement.innerHTML = `<option value="">${placeholderText}</option>`;
            data.forEach(item => {
                const option = document.createElement('option');
                option.value = item.value;
                option.textContent = item.text;
                selectElement.appendChild(option);
            });
        }

        function showFullScreenLoading() {
            console.log("Showing full screen loading.");
            fullScreenLoadingOverlay.classList.add('active');
        }

        function hideFullScreenLoading() {
            console.log("Hiding full screen loading.");
            fullScreenLoadingOverlay.classList.remove('active');
        }

        /**
         * Hiển thị một thông báo tùy chỉnh thay vì alert().
         * @param {string} message - Nội dung thông báo.
         * @param {boolean} [isConfirm=false] - True nếu là hộp thoại xác nhận.
         * @param {function} [callback=null] - Callback function cho hộp thoại xác nhận.
         */
        function showCustomMessageBox(message, isConfirm = false, callback = null) {
            console.log("Showing custom message box:", message, "isConfirm:", isConfirm);
            const overlay = document.getElementById('customMessageBoxOverlay');
            const messageText = document.getElementById('customMessageText');
            const closeButton = document.getElementById('closeCustomMessageBox');
            // Note: confirmButton and cancelButton are not in the HTML for customMessageBoxOverlay,
            // so their handlers are not directly used here. The confirmationBoxOverlay handles confirms.

            messageText.textContent = message;

            // Define handlers before removing/adding listeners
            const closeHandler = () => { cleanup(); if (!isConfirm && callback) callback(); };
            const overlayClickHandler = (event) => {
                if (event.target === overlay) {
                    cleanup();
                    if (isConfirm && callback) callback(false); // Treat outside click as cancel for confirmation
                    else if (!isConfirm && callback) callback(); // For simple messages
                }
            };

            // Remove previous listeners to prevent multiple firings
            closeButton.removeEventListener('click', closeHandler);
            overlay.removeEventListener('click', overlayClickHandler); // Remove previous overlay listener


            overlay.classList.add('show');

            const cleanup = () => {
                overlay.classList.remove('show');
                closeButton.removeEventListener('click', closeHandler);
                overlay.removeEventListener('click', overlayClickHandler);
            };

            closeButton.addEventListener('click', closeHandler);
            overlay.addEventListener('click', overlayClickHandler);
        }

        // Initial setup for the default close button
        closeCustomMessageBox.addEventListener('click', () => {
            showCustomMessageBox(''); // Call with empty message to just close
        });

        /**
         * Hiển thị hộp thoại xác nhận tùy chỉnh.
         * @param {string} message - Nội dung xác nhận.
         * @param {function} onConfirm - Hàm callback khi người dùng xác nhận.
         * @param {function} [onCancel=null] - Hàm callback khi người dùng hủy.
         */
        function showConfirmationBox(message, onConfirm, onCancel = null) {
            confirmationMessageText.textContent = message;
            confirmationBoxOverlay.classList.add('show');
            
            // Clear previous listeners to prevent multiple calls
            confirmActionButton.removeEventListener('click', handleConfirm);
            cancelActionButton.removeEventListener('click', handleCancel);
            confirmationBoxOverlay.removeEventListener('click', handleOverlayClick);

            const handleConfirm = () => {
                confirmationBoxOverlay.classList.remove('show');
                onConfirm();
                cleanupListeners();
            };

            const handleCancel = () => {
                confirmationBoxOverlay.classList.remove('show');
                if (onCancel) onCancel();
                cleanupListeners();
            };

            const handleOverlayClick = (event) => {
                if (event.target === confirmationBoxOverlay) {
                    confirmationBoxOverlay.classList.remove('show');
                    if (onCancel) onCancel();
                    cleanupListeners();
                }
            };

            const cleanupListeners = () => {
                confirmActionButton.removeEventListener('click', handleConfirm);
                cancelActionButton.removeEventListener('click', handleCancel);
                confirmationBoxOverlay.removeEventListener('click', handleOverlayClick);
            };

            confirmActionButton.addEventListener('click', handleConfirm);
            cancelActionButton.addEventListener('click', handleCancel);
            confirmationBoxOverlay.addEventListener('click', handleOverlayClick);
        }

        // JavaScript để hiển thị ngày và giờ hiện tại
        function updateCurrentDate() {
            const now = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            const dateElement = document.getElementById('currentDate');
            if (dateElement) {
                dateElement.textContent = now.toLocaleDateString('vi-VN', options);
            }
        }
        setInterval(updateCurrentDate, 60000);

        // JavaScript để xử lý dropdown người dùng
        function setupUserInfoDropdown() {
            const userInfo = document.getElementById('userInfo');
            const userDropdown = document.getElementById('userDropdown');
            const changePasswordBtn = document.getElementById('changePasswordBtn');
            const logoutBtn = document.getElementById('logoutBtn');

            if (userInfo && userDropdown) {
                userInfo.addEventListener('click', (event) => {
                    event.stopPropagation();
                    userDropdown.classList.toggle('show');
                    // Close notification dropdown if open
                    if (notificationDropdown.classList.contains('show')) {
                        notificationDropdown.classList.remove('show');
                    }
                });

                document.body.addEventListener('click', (event) => {
                    if (userDropdown.classList.contains('show') && !userInfo.contains(event.target)) {
                        userDropdown.classList.remove('show');
                    }
                });
            }

            if (changePasswordBtn) {
                changePasswordBtn.addEventListener('click', () => {
                    showFullScreenLoading();
                    // Simulate WebView2 postMessage for change password
                    showCustomMessageBox('Chức năng đổi mật khẩu đang được phát triển.');
                    userDropdown.classList.remove('show');
                    setTimeout(hideFullScreenLoading, 1000);
                });
            }

            if (logoutBtn) {
                logoutBtn.addEventListener('click', () => {
                    // Simulate WebView2 postMessage for logout
                    showCustomMessageBox('Bạn đã đăng xuất thành công.');
                    userDropdown.classList.remove('show');
                });
            }
        }

        async function fetchEmployeeInfo() {
            const employeeNameSpan = document.getElementById('employeeName');
            const employeeTitleSpan = document.getElementById('employeeTitle');
            const userRole = document.body.dataset.userRole;

            if (employeeNameSpan && employeeTitleSpan) {
                // Simulate API call
                showFullScreenLoading();
                try {
                    await new Promise(resolve => setTimeout(resolve, 500)); // Simulate network delay
                    if (userRole === 'admin') {
                        employeeNameSpan.textContent = 'Admin';
                        employeeTitleSpan.textContent = 'Quản trị viên';
                    } else {
                        employeeNameSpan.textContent = 'Nhân Viên';
                        employeeTitleSpan.textContent = 'Nhân viên hệ thống';
                    }
                } catch (error) {
                    console.error('Error fetching employee info:', error);
                    employeeNameSpan.textContent = 'Lỗi';
                    employeeTitleSpan.textContent = 'Không xác định';
                } finally {
                    hideFullScreenLoading();
                }
            }
        }

        // JavaScript để xử lý dropdown thông báo
        const notificationIcon = document.getElementById('notificationIcon');
        const notificationDropdown = document.getElementById('notificationDropdown');
        const notificationCountBadge = document.getElementById('notificationCountBadge');
        const notificationList = document.getElementById('notificationList'); // Changed to notificationList
        const clearNotificationsBtn = document.getElementById('clearNotificationsBtn'); // Changed from markAllReadBtn

        // Global array to hold current notifications
        let activeNotifications = [];

        /**
         * Cập nhật số lượng thông báo trên huy hiệu.
         * @param {number} count - Số lượng thông báo chưa đọc.
         */
        function updateNotificationCount(count) {
            if (notificationCountBadge) {
                notificationCountBadge.textContent = count > 99 ? '99+' : count; // Limit display to 99+
                if (count > 0) {
                    notificationCountBadge.style.display = 'block';
                } else {
                    notificationCountBadge.style.display = 'none';
                }
            }
        }

        /**
         * Checks if two dates are on the same day.
         * @param {Date} d1 - First date.
         * @param {Date} d2 - Second date.
         * @returns {boolean} - True if same day, false otherwise.
         */
        function isSameDay(d1, d2) {
            return d1.getFullYear() === d2.getFullYear() &&
                   d1.getMonth() === d2.getMonth() &&
                   d1.getDate() === d2.getDate();
        }

        /**
         * Determines the time category for a given notification date.
         * @param {Date} notificationDate - The date of the notification.
         * @returns {string} - The time category (e.g., 'Mới', 'Hôm nay', 'Hôm qua').
         */
        function getTimeCategory(notificationDate) {
            const now = new Date();
            const oneHourAgo = new Date(now.getTime() - 60 * 60 * 1000);
            const yesterday = new Date(now);
            yesterday.setDate(now.getDate() - 1);
            yesterday.setHours(0, 0, 0, 0); // Normalize to start of day for accurate comparison

            const startOfWeek = new Date(now);
            startOfWeek.setDate(now.getDate() - now.getDay()); // Sunday
            startOfWeek.setHours(0, 0, 0, 0);

            const startOfMonth = new Date(now.getFullYear(), now.getMonth(), 1);
            startOfMonth.setHours(0, 0, 0, 0);

            // Normalize notificationDate to exclude seconds and milliseconds for comparison
            const normalizedNotificationDate = new Date(notificationDate.getFullYear(), notificationDate.getMonth(), notificationDate.getDate(), notificationDate.getHours(), notificationDate.getMinutes());


            if (normalizedNotificationDate > oneHourAgo) {
                return 'Mới';
            } else if (isSameDay(normalizedNotificationDate, now)) {
                return 'Hôm nay';
            } else if (isSameDay(normalizedNotificationDate, yesterday)) {
                return 'Hôm qua';
            } else if (normalizedNotificationDate >= startOfWeek) {
                return 'Tuần này';
            } else if (normalizedNotificationDate >= startOfMonth) {
                return 'Tháng này';
            }
            return 'Cũ hơn';
        }

        /**
         * Formats a date into a human-readable "time ago" string.
         * @param {Date} date - The date to format.
         * @returns {string} - Formatted time string.
         */
        function formatTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);

            let interval = seconds / 31536000; // years
            if (interval > 1) {
                return Math.floor(interval) + " năm trước";
            }
            interval = seconds / 2592000; // months
            if (interval > 1) {
                return Math.floor(interval) + " tháng trước";
            }
            interval = seconds / 86400; // days
            if (interval > 1) {
                return Math.floor(interval) + " ngày trước";
            }
            interval = seconds / 3600; // hours
            if (interval > 1) {
                return Math.floor(interval) + " giờ trước";
            }
            interval = seconds / 60; // minutes
            if (interval > 1) {
                return Math.floor(interval) + " phút trước";
            }
            return Math.floor(seconds) + " giây trước";
        }

        /**
         * Renders the list of notifications in the dropdown.
         * @param {Array<Object>} notifications - Array of notification objects.
         */
        function renderNotifications(notifications) {
            notificationList.innerHTML = ''; // Clear existing notifications
            if (notifications.length === 0) {
                notificationList.innerHTML = '<li class="no-notifications">Không có thông báo mới.</li>';
                clearNotificationsBtn.style.display = 'none';
                updateNotificationCount(0);
                return;
            }

            clearNotificationsBtn.style.display = 'block';

            // Sort notifications by date (newest first)
            notifications.sort((a, b) => b.date.getTime() - a.date.getTime());

            const groupedNotifications = {
                'Mới': [],
                'Hôm nay': [],
                'Hôm qua': [],
                'Tuần này': [],
                'Tháng này': [],
                'Cũ hơn': []
            };

            // Group notifications by time category
            notifications.forEach(notif => {
                const category = getTimeCategory(notif.date);
                if (!groupedNotifications[category]) {
                    groupedNotifications[category] = [];
                }
                groupedNotifications[category].push(notif);
            });

            const categoryOrder = ['Mới', 'Hôm nay', 'Hôm qua', 'Tuần này', 'Tháng này', 'Cũ hơn'];

            // Render notifications grouped by category
            categoryOrder.forEach(category => {
                if (groupedNotifications[category].length > 0) {
                    const categoryHeader = document.createElement('li'); // Changed to li for list
                    categoryHeader.classList.add('notification-dropdown-header'); // Re-using existing style for category
                    categoryHeader.innerHTML = `<h3>${category}</h3>`; // Added h3 for consistent styling
                    notificationList.appendChild(categoryHeader);

                    groupedNotifications[category].forEach(notif => {
                        const notificationItem = document.createElement('li'); // Changed to li
                        notificationItem.classList.add('notification-item');
                        notificationItem.dataset.id = notif.id;
                        notificationItem.innerHTML = `
                            <strong>${notif.title}:</strong> ${notif.message}
                            <span class="time">${formatTimeAgo(notif.date)}</span>
                        `;
                        notificationList.appendChild(notificationItem);

                        // Add event listener to mark as read
                        notificationItem.addEventListener('click', (event) => {
                            event.stopPropagation();
                            markNotificationAsRead(notif.id);
                            // Optionally, close the dropdown after marking one as read
                            notificationDropdown.classList.remove('show');
                        });
                    });
                }
            });
            updateNotificationCount(notifications.length);
        }

        /**
         * Marks a specific notification as read and re-renders the list.
         * @param {string} id - The ID of the notification to mark as read.
         */
        function markNotificationAsRead(id) {
            activeNotifications = activeNotifications.filter(notif => notif.id !== id);
            renderNotifications(activeNotifications);
            showCustomMessageBox(`Thông báo "${id}" đã được đánh dấu là đã đọc.`);
            notificationDropdown.classList.remove('show');
        }

        // Initial mock notifications with Date objects
        activeNotifications = [
            { id: 'notif1', title: 'Thông báo 1', message: 'Học viên mới đã đăng ký.', date: new Date(Date.now() - 30 * 60 * 1000) }, // 30 mins ago (Mới)
            { id: 'notif2', title: 'Thông báo 2', message: 'Lịch học sắp tới.', date: new Date(Date.now() - 5 * 60 * 60 * 1000) }, // 5 hours ago (Hôm nay)
            { id: 'notif3', title: 'Thông báo 3', message: 'Yêu cầu hỗ trợ mới.', date: new Date(Date.now() - 24 * 60 * 60 * 1000 - 2 * 60 * 60 * 1000) }, // Yesterday (Hôm qua)
            { id: 'notif4', title: 'Thông báo 4', message: 'Khóa học mới được thêm.', date: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000) }, // 3 days ago (Tuần này)
            { id: 'notif5', title: 'Thông báo 5', message: 'Cập nhật hệ thống.', date: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000) }, // 15 days ago (Tháng này)
            { id: 'notif6', title: 'Thông báo 6', message: 'Báo cáo hàng tháng đã sẵn sàng.', date: new Date(Date.now() - 40 * 24 * 60 * 60 * 1000) }, // 40 days ago (Cũ hơn)
        ];
        renderNotifications(activeNotifications); // Render initial notifications

        if (notificationIcon && notificationDropdown) {
            notificationIcon.addEventListener('click', (event) => {
                event.stopPropagation(); // Prevent click event from propagating to body
                notificationDropdown.classList.toggle('show');
                // Close user dropdown if open
                if (userDropdown.classList.contains('show')) {
                    userDropdown.classList.remove('show');
                }
            });

            document.body.addEventListener('click', (event) => {
                // Close notification dropdown if clicked outside
                if (notificationDropdown.classList.contains('show') && !notificationIcon.contains(event.target) && !notificationDropdown.contains(event.target)) {
                    notificationDropdown.classList.remove('show');
                }
            });
        }

        if (clearNotificationsBtn) {
            clearNotificationsBtn.addEventListener('click', () => {
                activeNotifications = []; // Clear all notifications
                renderNotifications(activeNotifications); // Re-render to show "No notifications"
                notificationDropdown.classList.remove('show'); // Close dropdown
                showCustomMessageBox('Tất cả thông báo đã được đánh dấu là đã đọc.');
            });
        }

        function setLoggedInUserName(name) {
            const userNameSpan = document.getElementById('employeeName');
            if (userNameSpan) {
                userNameSpan.textContent = name;
            }
        }

        function setLoggedInUserTitle(title) {
            const userTitleSpan = document.getElementById('employeeTitle');
            if (userTitleSpan) {
                userTitleSpan.textContent = title;
            }
        }

        // --- Chức năng cho Bảng Tổng Hợp Tài Liệu ---
        const documentTableBody = document.getElementById('documentTableBody');
        const searchInput = document.getElementById('searchInput');
        const addDocumentRequestBtn = document.getElementById('addDocumentRequestBtn');

        let allDocumentData = []; // Biến toàn cục để lưu trữ tất cả dữ liệu tài liệu
        let allDocumentTypeData = []; // Dữ liệu loại tài liệu
        let allDepartmentData = []; // Dữ liệu phòng ban
        let allStatusData = []; // Dữ liệu trạng thái

        /**
         * Định dạng ngày giờ.
         * @param {string} dateTimeString - Chuỗi ngày giờ.
         * @returns {string} Ngày giờ đã định dạng.
         */
        function formatDateTime(dateTimeString) {
            if (!dateTimeString) return '';
            const date = new Date(dateTimeString);
            return date.toLocaleString('vi-VN', {
                year: 'numeric', month: '2-digit', day: '2-digit',
                hour: '2-digit', minute: '2-digit', second: '2-digit'
            });
        }

        /**
         * Hiển thị dữ liệu tài liệu lên bảng.
         * @param {Array<Object>} documentList - Mảng các đối tượng tài liệu.
         */
        function renderDocumentTable(documentList) {
            documentTableBody.innerHTML = ''; // Xóa nội dung hiện có
            if (documentList && documentList.length > 0) {
                documentList.forEach(doc => {
                    const row = document.createElement('tr');
                    // Tìm tên loại tài liệu và phòng ban từ dữ liệu đã tải
                    const docTypeName = allDocumentTypeData.find(type => type.documentTypeId == doc.documentTypeId)?.documentTypeName || doc.documentTypeId;
                    const deptName = allDepartmentData.find(dept => dept.departmentId == doc.departmentId)?.departmentName || doc.documentId;
                    const statusName = allStatusData.find(status => status.statusId == doc.statusId)?.statusName || doc.statusId;

                    row.innerHTML = `
                        <td>${doc.documentId || ''}</td>
                        <td>${doc.documentName || ''}</td>
                        <td>${docTypeName}</td>
                        <td>${deptName}</td>
                        <td>${statusName}</td>
                        <td>${formatDateTime(doc.modifiedDate)}</td>
                        <td>${doc.creatorEmployeeId || ''}</td>
                        <td class="actions">
                            <button class="view-btn" data-document-id="${doc.documentId}">Xem</button>
                            <button class="download-btn" data-document-id="${doc.documentId}">Tải xuống</button>
                            ${(currentUserRole === 'admin' || currentUserRole === 'manager') ? `
                                <button class="edit-btn" data-document-id="${doc.documentId}">Sửa</button>
                                <button class="delete-btn" data-document-id="${doc.documentId}">Xóa</button>
                            ` : ''}
                        </td>
                    `;
                    documentTableBody.appendChild(row);
                });

                // Gắn sự kiện cho các nút
                document.querySelectorAll('.view-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const documentId = event.target.dataset.documentId;
                        viewDocument(documentId);
                    });
                });
                document.querySelectorAll('.download-btn').forEach(button => {
                    button.addEventListener('click', (event) => {
                        const documentId = event.target.dataset.documentId;
                        downloadDocument(documentId);
                    });
                });

                // Chỉ gắn sự kiện cho nút Sửa/Xóa nếu người dùng có quyền
                if (currentUserRole === 'admin' || currentUserRole === 'manager') {
                    document.querySelectorAll('.edit-btn').forEach(button => {
                        button.addEventListener('click', (event) => {
                            const documentId = event.target.dataset.documentId;
                            editDocument(documentId); // This function will now call viewDocument and set editable fields
                        });
                    });
                    document.querySelectorAll('.delete-btn').forEach(button => {
                        button.addEventListener('click', (event) => {
                            const documentId = event.target.dataset.documentId;
                            showConfirmationBox(`Bạn có chắc chắn muốn xóa tài liệu ID ${documentId} không?`, () => {
                                deleteDocument(documentId);
                            });
                        });
                    });
                }

            } else {
                documentTableBody.innerHTML = '<tr><td colspan="8" class="text-center text-gray-500 py-4">Không có dữ liệu tài liệu.</td></tr>';
            }
        }

        /**
         * Hàm tìm kiếm tài liệu.
         */
        function performSearch() {
            const searchTerm = searchInput.value.toLowerCase();
            const filteredDocuments = allDocumentData.filter(doc => {
                // Tìm kiếm trong tất cả các trường của mỗi tài liệu
                for (const key in doc) {
                    if (doc[key] && String(doc[key]).toLowerCase().includes(searchTerm)) {
                        return true;
                    }
                }
                // Tìm kiếm cả theo tên loại tài liệu và phòng ban
                const docTypeName = allDocumentTypeData.find(type => type.documentTypeId == doc.documentTypeId)?.documentTypeName || '';
                if (docTypeName.toLowerCase().includes(searchTerm)) return true;
                const deptName = allDepartmentData.find(dept => dept.departmentId == doc.departmentId)?.departmentName || '';
                if (deptName.toLowerCase().includes(searchTerm)) return true;
                const statusName = allStatusData.find(status => status.statusId == doc.statusId)?.statusName || '';
                if (statusName.toLowerCase().includes(searchTerm)) return true;

                return false;
            });
            renderDocumentTable(filteredDocuments);
        }

        // Gắn sự kiện cho thanh tìm kiếm
        if (searchInput) {
            searchInput.addEventListener('input', performSearch); // Tìm kiếm khi gõ
        }

        // --- Chức năng Yêu cầu thêm tài liệu mới (Modal) ---
        const addDocumentRequestModal = document.getElementById('addDocumentRequestModal');
        const closeAddRequestModalBtn = document.getElementById('closeAddRequestModalBtn');
        const cancelAddRequestBtn = document.getElementById('cancelAddRequestBtn');
        const addDocumentRequestForm = document.getElementById('addDocumentRequestForm');

        // Mở modal yêu cầu thêm
        if (addDocumentRequestBtn) {
            addDocumentRequestBtn.addEventListener('click', () => {
                addDocumentRequestForm.reset(); // Clear form fields
                // Populate dropdowns for add request modal
                populateDropdown('addDocumentType', allDocumentTypeData.map(d => ({ value: d.documentTypeId, text: d.documentTypeName })), 'Chọn loại tài liệu');
                populateDropdown('addDepartment', allDepartmentData.map(d => ({ value: d.departmentId, text: d.departmentName })), 'Chọn phòng ban');
                addDocumentRequestModal.classList.add('show');
            });
        }

        // Đóng modal yêu cầu thêm
        function closeAddRequestModal() {
            addDocumentRequestModal.classList.remove('show');
        }

        if (closeAddRequestModalBtn) {
            closeAddRequestModalBtn.addEventListener('click', closeAddRequestModal);
        }
        if (cancelAddRequestBtn) {
            cancelAddRequestBtn.addEventListener('click', closeAddRequestModal);
        }
        addDocumentRequestModal.addEventListener('click', (event) => {
            if (event.target === addDocumentRequestModal) { // Đóng khi click ra ngoài modal content
                closeAddRequestModal();
            }
        });

        // Xử lý submit form yêu cầu thêm mới
        if (addDocumentRequestForm) {
            addDocumentRequestForm.addEventListener('submit', function(event) {
                event.preventDefault();
                showFullScreenLoading();

                const newDocumentRequestData = {
                    documentName: document.getElementById('addDocumentName').value,
                    documentTypeId: parseInt(document.getElementById('addDocumentType').value, 10),
                    departmentId: parseInt(document.getElementById('addDepartment').value, 10),
                    description: document.getElementById('addDescription').value,
                    reasonForRequest: document.getElementById('addReasonForRequest').value
                };

                console.log('New Document Request Data:', newDocumentRequestData);

                if (window.chrome && window.chrome.webview) {
                    window.chrome.webview.postMessage(JSON.stringify({
                        type: 'createDocumentRequest',
                        data: newDocumentRequestData
                    }));
                } else {
                    showCustomMessageBox('Chức năng yêu cầu thêm tài liệu chỉ hoạt động trong môi trường WebView2.');
                    hideFullScreenLoading();
                    // Simulate success for browser testing
                    setTimeout(() => {
                        showCustomMessageBox('Simulated: Yêu cầu thêm tài liệu đã được gửi thành công và đang chờ phê duyệt!');
                        closeAddRequestModal();
                    }, 1500);
                }
            });
        }

        // --- Chức năng Xem tài liệu (Modal) ---
        const viewEditDocumentModal = document.getElementById('viewEditDocumentModal');
        const closeViewEditModalBtn = document.getElementById('closeViewEditModalBtn');
        // Removed cancelEditDocumentBtn (no longer needed as no edit actions)
        // Removed editDocumentForm (no longer submitted, purely for display)
        // Removed uploadFileBtn, fileUploadInput, filePathHint elements
        // Removed saveDocumentBtn and editVersionNoteGroup

        // Tab buttons and content (removed, but keeping variables for consistency if re-added)
        const tabButtons = document.querySelectorAll('.modal-tab-button'); // This will now be empty
        const tabContents = document.querySelectorAll('.modal-tab-content'); // This will now only contain documentDetailsTab

        // No need to loop through tabButtons if only one tab exists.
        // The documentDetailsTab is always visible by default.

        // Đóng modal xem
        function closeViewEditModal() {
            viewEditDocumentModal.classList.remove('show');
            // No need to reset tabs if only one exists
        }

        if (closeViewEditModalBtn) {
            closeViewEditModalBtn.addEventListener('click', closeViewEditModal);
        }
        // No cancelEditDocumentBtn listener needed

        viewEditDocumentModal.addEventListener('click', (event) => {
            if (event.target === viewEditDocumentModal) { // Đóng khi click ra ngoài modal content
                closeViewEditModal();
            }
        });

        /**
         * Mở modal xem tài liệu và điền dữ liệu.
         * @param {string} documentId - ID tài liệu cần xem.
         */
        function viewDocument(documentId) {
            const docToView = allDocumentData.find(d => d.documentId == documentId);
            if (docToView) {
                // Điền dữ liệu vào form modal
                document.getElementById('editDocumentId').value = docToView.documentId;
                document.getElementById('editDocumentName').value = docToView.documentName || '';
                document.getElementById('editDescription').value = docToView.description || '';
                document.getElementById('editCreatedDate').value = formatDateTime(docToView.createdDate);
                document.getElementById('editCreatorEmployeeId').value = docToView.creatorEmployeeId || '';

                // Populate dropdowns (they will be disabled by default in HTML)
                populateDropdown('editDocumentType', allDocumentTypeData.map(d => ({ value: d.documentTypeId, text: d.documentTypeName })), 'Chọn loại tài liệu');
                populateDropdown('editDepartment', allDepartmentData.map(d => ({ value: d.departmentId, text: d.departmentName })), 'Chọn phòng ban');
                populateDropdown('editStatus', allStatusData.map(d => ({ value: d.statusId, text: d.statusName })), 'Chọn trạng thái');

                // Set selected values for dropdowns after population
                document.getElementById('editDocumentType').value = docToView.documentTypeId || '';
                document.getElementById('editDepartment').value = docToView.departmentId || '';
                document.getElementById('editStatus').value = docToView.statusId || '';

                viewEditDocumentModal.classList.add('show'); // Show modal
            } else {
                showCustomMessageBox('Không tìm thấy thông tin tài liệu để xem.');
            }
        }

        /**
         * Mở modal xem tài liệu (chức năng tương tự viewDocument).
         * @param {string} documentId - ID tài liệu cần xem.
         */
        function editDocument(documentId) {
            // Since direct editing is not allowed, "Sửa" button now behaves like "Xem"
            viewDocument(documentId);
        }

        // Removed renderVersionHistory and downloadFileVersion functions

        // Removed editDocumentForm submit listener (no longer needed as no edit actions)

        /**
         * Xử lý tải xuống tài liệu.
         * @param {string} documentId - ID của tài liệu cần tải xuống.
         */
        function downloadDocument(documentId) {
            showFullScreenLoading();
            const docToDownload = allDocumentData.find(d => d.documentId == documentId);
            if (docToDownload && docToDownload.filePath) {
                console.log(`Requesting download for document ${documentId} at path: ${docToDownload.filePath}`);
                if (window.chrome && window.chrome.webview) {
                    window.chrome.webview.postMessage(JSON.stringify({
                        type: 'downloadDocument',
                        filePath: docToDownload.filePath,
                        documentId: documentId
                    }));
                } else {
                    showCustomMessageBox('Chức năng tải xuống chỉ hoạt động trong môi trường WebView2.');
                    hideFullScreenLoading();
                }
            } else {
                showCustomMessageBox('Không tìm thấy đường dẫn tệp cho tài liệu này hoặc tài liệu không tồn tại.');
                hideFullScreenLoading();
            }
        }

        /**
         * Gửi yêu cầu xóa tài liệu đến backend.
         * @param {string} documentId - ID tài liệu cần xóa.
         */
        function deleteDocument(documentId) {
            if (currentUserRole !== 'admin' && currentUserRole !== 'manager') {
                showCustomMessageBox('Bạn không có quyền xóa tài liệu.');
                return;
            }
            showFullScreenLoading();
            console.log('Deleting document with ID:', documentId);

            if (window.chrome && window.chrome.webview) {
                window.chrome.webview.postMessage(JSON.stringify({
                    type: 'deleteDocument',
                    documentId: documentId
                }));
            } else {
                showCustomMessageBox('Chức năng xóa chỉ hoạt động trong môi trường WebView2.');
                hideFullScreenLoading();
                // Simulate deletion for browser testing
                setTimeout(() => {
                    allDocumentData = allDocumentData.filter(d => d.documentId != documentId);
                    renderDocumentTable(allDocumentData);
                    showCustomMessageBox('Simulated: Xóa tài liệu thành công!');
                }, 1500);
            }
        }


        // Lắng nghe thông báo từ C#
        if (window.chrome && window.chrome.webview) {
            window.chrome.webview.addEventListener('message', event => {
                const message = JSON.parse(event.data);
                if (message.type === 'documentListData') {
                    allDocumentData = message.data; // Lưu trữ dữ liệu gốc
                    renderDocumentTable(allDocumentData);
                    hideFullScreenLoading();
                } else if (message.type === 'documentTypeData') {
                    allDocumentTypeData = message.data;
                    // Re-render table if document data is already loaded to show names
                    if (allDocumentData.length > 0) renderDocumentTable(allDocumentData);
                } else if (message.type === 'departmentData') {
                    allDepartmentData = message.data;
                    if (allDocumentData.length > 0) renderDocumentTable(allDocumentData);
                } else if (message.type === 'statusData') {
                    allStatusData = message.data;
                    if (allDocumentData.length > 0) renderDocumentTable(allDocumentData);
                } else if (message.type === 'loggedInUserName') {
                    setLoggedInUserName(message.name);
                    setLoggedInUserTitle(message.title);
                } else if (message.type === 'userRole') { // Receive user role from C#
                    currentUserRole = message.role;
                    document.body.dataset.userRole = currentUserRole; // Update data attribute
                    // Re-render table to update action buttons based on new role
                    if (allDocumentData.length > 0) renderDocumentTable(allDocumentData);
                    // Hide/show add button based on role
                    if (currentUserRole === 'admin' || currentUserRole === 'manager') {
                        addDocumentRequestBtn.style.display = 'inline-flex'; // Use inline-flex for button styling
                    } else {
                        addDocumentRequestBtn.style.display = 'none';
                    }
                } else if (message.type === 'createDocumentRequestStatus') {
                    hideFullScreenLoading();
                    if (message.success) {
                        showCustomMessageBox('Yêu cầu thêm tài liệu đã được gửi thành công và đang chờ phê duyệt!');
                        closeAddRequestModal();
                        // No need to request document list data here, as it's a request, not a direct add.
                        // The document will appear in the list only after approval and actual creation.
                    } else {
                        showCustomMessageBox('Lỗi khi gửi yêu cầu thêm tài liệu: ' + message.error);
                    }
                } else if (message.type === 'updateDocumentStatus') {
                    hideFullScreenLoading();
                    if (message.success) {
                        showCustomMessageBox('Cập nhật thông tin tài liệu thành công!');
                        closeViewEditModal();
                        // Yêu cầu tải lại dữ liệu bảng sau khi cập nhật
                        if (window.chrome && window.chrome.webview) {
                            window.chrome.webview.postMessage(JSON.stringify({ type: 'requestDocumentListData' }));
                        }
                    } else {
                        showCustomMessageBox('Lỗi khi cập nhật thông tin tài liệu: ' + message.error);
                    }
                } else if (message.type === 'deleteDocumentStatus') {
                    hideFullScreenLoading();
                    if (message.success) {
                        showCustomMessageBox('Xóa tài liệu thành công!');
                        if (window.chrome && window.chrome.webview) {
                            window.chrome.webview.postMessage(JSON.stringify({ type: 'requestDocumentListData' }));
                        }
                    } else {
                        showCustomMessageBox('Lỗi khi xóa tài liệu: ' + message.error);
                    }
                } else if (message.type === 'downloadDocumentStatus') {
                    hideFullScreenLoading();
                    if (!message.success) {
                        showCustomMessageBox('Lỗi khi tải xuống tài liệu: ' + message.error);
                    } else {
                        // C# WebView2 will handle the actual file download, no need for client-side logic here
                        showCustomMessageBox('Yêu cầu tải xuống đã được gửi.');
                    }
                }
                // Removed downloadFileVersionStatus handler
            });
        }

        // Yêu cầu C# cung cấp dữ liệu ban đầu khi trang tải xong
        document.addEventListener('DOMContentLoaded', function() {
            showFullScreenLoading();
            updateCurrentDate();
            fetchEmployeeInfo();
            setupUserInfoDropdown();

            if (window.chrome && window.chrome.webview) {
                window.chrome.webview.postMessage(JSON.stringify({ type: 'requestDocumentListData' })); // Yêu cầu dữ liệu tài liệu
                window.chrome.webview.postMessage(JSON.stringify({ type: 'requestDocumentTypeData' })); // Yêu cầu dữ liệu loại tài liệu
                window.chrome.webview.postMessage(JSON.stringify({ type: 'requestDepartmentData' })); // Yêu cầu dữ liệu phòng ban
                window.chrome.webview.postMessage(JSON.stringify({ type: 'requestStatusData' })); // Yêu cầu dữ liệu trạng thái
                window.chrome.webview.postMessage(JSON.stringify({ type: 'requestLoggedInUserName' }));
                window.chrome.webview.postMessage(JSON.stringify({ type: 'requestUserRole' })); // Request user role
            } else {
                // Simulate data for browser environment
                currentUserRole = 'normal'; // Simulate normal user role for browser testing
                document.body.dataset.userRole = currentUserRole;
                const addDocumentRequestBtnElement = document.getElementById('addDocumentRequestBtn');
                if (addDocumentRequestBtnElement) {
                    addDocumentRequestBtnElement.style.display = 'none'; // Hide add button for normal user
                }

                allDocumentTypeData = [
                    { documentTypeId: 1, documentTypeName: 'Hợp đồng' },
                    { documentTypeId: 2, documentTypeName: 'Báo cáo' },
                    { documentTypeId: 3, documentTypeName: 'Kế hoạch' }
                ];
                allDepartmentData = [
                    { departmentId: 101, departmentName: 'Phòng Kế toán' },
                    { departmentId: 102, departmentName: 'Phòng Kinh doanh' },
                    { departmentId: 103, departmentName: 'Phòng Nhân sự' }
                ];
                allStatusData = [
                    { statusId: 1, statusName: 'Đang hoạt động' },
                    { statusId: 2, statusName: 'Lưu trữ' },
                    { statusId: 3, statusName: 'Đã xóa' },
                    { statusId: 4, statusName: 'Chờ phê duyệt' }
                ];

                allDocumentData = [
                    {
                        documentId: 1,
                        documentName: 'Hợp đồng lao động 2024',
                        documentTypeId: 1,
                        departmentId: 103,
                        physicalLocation: 'Tủ hồ sơ P.NS', // Kept for mock data consistency, but not displayed
                        filePath: 'C:\\Documents\\HopDongLaoDong2024.pdf', // Kept for mock data consistency, but not displayed
                        description: 'Hợp đồng mẫu cho nhân viên mới năm 2024.',
                        createdDate: '2024-01-15T10:00:00Z',
                        creatorEmployeeId: 'NV001',
                        modifiedDate: '2024-06-20T14:30:00Z', // Still used for table display
                        modifierEmployeeId: 'NV005', // Kept for mock data consistency, but not displayed
                        statusId: 1,
                        documentVersions: [] // Removed versions, empty array
                    },
                    {
                        documentId: 2,
                        documentName: 'Báo cáo tài chính Q2/2024',
                        documentTypeId: 2,
                        departmentId: 101,
                        physicalLocation: 'Server Kế toán',
                        filePath: 'C:\\Reports\\BaoCaoTaiChinhQ2_2024.xlsx',
                        description: 'Báo cáo tài chính quý 2 năm 2024.',
                        createdDate: '2024-07-01T09:00:00Z',
                        creatorEmployeeId: 'NV002',
                        modifiedDate: '2024-07-01T09:00:00Z',
                        modifierEmployeeId: 'NV002',
                        statusId: 1,
                        documentVersions: []
                    },
                    {
                        documentId: 3,
                        documentName: 'Kế hoạch Marketing cuối năm',
                        documentTypeId: 3,
                        departmentId: 102,
                        physicalLocation: 'Google Drive',
                        filePath: 'https://docs.google.com/MarketingPlan.docx',
                        description: 'Kế hoạch marketing cho các chiến dịch cuối năm.',
                        createdDate: '2024-05-10T11:00:00Z',
                        creatorEmployeeId: 'NV003',
                        modifiedDate: '2024-05-10T11:00:00Z',
                        modifierEmployeeId: 'NV003',
                        statusId: 4, // Chờ phê duyệt
                        documentVersions: []
                    }
                ];

                renderDocumentTable(allDocumentData);
                populateDropdown('addDocumentType', allDocumentTypeData.map(d => ({ value: d.documentTypeId, text: d.documentTypeName })), 'Chọn loại tài liệu');
                populateDropdown('addDepartment', allDepartmentData.map(d => ({ value: d.departmentId, text: d.departmentName })), 'Chọn phòng ban');
                populateDropdown('editDocumentType', allDocumentTypeData.map(d => ({ value: d.documentTypeId, text: d.documentTypeName })), 'Chọn loại tài liệu');
                populateDropdown('editDepartment', allDepartmentData.map(d => ({ value: d.departmentId, text: d.departmentName })), 'Chọn phòng ban');
                populateDropdown('editStatus', allStatusData.map(d => ({ value: d.statusId, text: d.statusName })), 'Chọn trạng thái');

                setLoggedInUserName('Nguyễn Văn B (Admin)');
                setLoggedInUserTitle('admin');
                hideFullScreenLoading();
            }
        });
    </script>
</body>
</html>
